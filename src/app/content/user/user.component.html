<div class="container">
  <div class="register-wrapper">
    <h2 class="heading" *ngIf="!userId">Register</h2>
    <h2 class="heading" *ngIf="userId">My Profile</h2>
    <form [formGroup]="userForm" enctype="multipart/form-data" novalidate (ngSubmit)="onSubmit(userForm.valid)">

      <!--first name-->
      <div class="form-group row">
        <label for="name" class="col-sm-4 col-form-label">Name</label>
        <div class="col-sm-8">
          <input type="text" class="form-control" id="name" formControlName="name" placeholder="Name">
          <p *ngIf="submitted && userForm.get('name').hasError('required')" class="error-msg">
              First name is required.
          </p>
          <p *ngIf="submitted && userForm.get('name').hasError('minlength')" class="error-msg">
            First name must be at least 2 characters long.
          </p>
          <p *ngIf="submitted && userForm.get('name').hasError('pattern')" class="error-msg">
            Only alphabets are allowed.
          </p>
        </div>
      </div>

      <!--email-->
      <div class="form-group row">
        <label for="email" class="col-sm-4 col-form-label">Email</label>
        <div class="col-sm-8">
          <input type="email" class="form-control" id="email" formControlName="email" placeholder="Email">
          <p *ngIf="submitted && userForm.get('email').hasError('required')" class="error-msg">
              Email is required.
          </p>
          <p *ngIf="submitted && userForm.get('email').hasError('pattern')" class="error-msg">
            Please enter a valid email.
          </p>
        </div>
      </div>

      <!--password-->
      <div class="form-group row" formGroupName="credentials">
        <label for="password" class="col-sm-4 col-form-label">Password</label>
        <div class="col-sm-8">
          <input type="password" class="form-control" id="password" formControlName="password" placeholder="Password">
          <p *ngIf="submitted && userForm.get('credentials').get('password').hasError('required')" class="error-msg">
              Password is required.
          </p>
        </div>
      </div>

      <!--confirm password-->
      <div class="form-group row" formGroupName="credentials">
        <label for="confirm-password" class="col-sm-4 col-form-label">Confirm Password</label>
        <div class="col-sm-8">
          <input type="password" class="form-control" id="confirm-password" formControlName="confirmPassword" placeholder="Confirm Password">
          <p class="error-msg" *ngIf="submitted && userForm.get('credentials').hasError('nomatch')">
            Entered password does not match.
          </p>
        </div>
      </div>

      <!--phone-->
      <div class="form-group row">
        <label for="phone" class="col-sm-4 col-form-label">Phone</label>
        <div class="col-sm-8">
          <input type="number" class="form-control" id="phone" formControlName="phone" placeholder="Phone">
          <p *ngIf="submitted && userForm.get('phone').hasError('required')" class="error-msg">
              Phone number is required.
          </p>
          <p *ngIf="submitted && userForm.get('phone').hasError('pattern')" class="error-msg">
            Please enter a valid phone number.
          </p>
        </div>
      </div>

      <!--designation-->
      <div class="form-group row">
        <label for="designation" class="col-sm-4 col-form-label">Designation</label>
        <div class="col-sm-8">
          <select class="form-control" id="designation" formControlName="designation">
            <option [selected]="!selectedDesignation">Select Designation</option>
            <option *ngFor="let name of designations" [selected]="selectedDesignation === name" [ngValue]="name">{{name}}</option>
          </select>
          <p *ngIf="submitted && userForm.get('designation').hasError('required')" class="error-msg">
              Designation is required.
          </p>
        </div>
      </div>

      <!--date of birth-->
      <div class="form-group row">
        <label for="dob" class="col-sm-4 col-form-label">Date of Birth</label>
        <div class="col-sm-8">
          <input type="date" class="form-control" id="dob" formControlName="dob" placeholder="Date of Birth" [(ngModel)]="setDobDate">
          <p *ngIf="submitted && userForm.get('dob').hasError('required')" class="error-msg">
              This field is required.
          </p>
        </div>
      </div>

      <!--date of joining-->
      <div class="form-group row">
        <label for="doj" class="col-sm-4 col-form-label">Date of Joining</label>
        <div class="col-sm-8">
          <input type="date" class="form-control" id="doj" formControlName="doj" placeholder="Date of Joining" [(ngModel)]="setDojDate">
          <p *ngIf="submitted && userForm.get('doj').hasError('required')" class="error-msg">
              This field is required.
          </p>
        </div>
      </div>

      <!--previous experience-->
      <div class="form-group row">
        <label for="previousExp" class="col-sm-4 col-form-label">Previous experience</label>
        <div class="col-sm-8">
          <input type="text" class="form-control" id="previousExp" formControlName="previousExp" placeholder="Previous experience">
          <p *ngIf="submitted && userForm.get('previousExp').hasError('required')" class="error-msg">
              Previous Exp is required.
          </p>
          <p *ngIf="submitted && userForm.get('previousExp').hasError('pattern')" class="error-msg">
            Only numbers are allowed.
          </p>
        </div>
      </div>

      <!--domain-->
      <div class="form-group row">
        <label for="domain" class="col-sm-4 col-form-label">Domain</label>
        <div class="col-sm-8">
          <select class="form-control" id="domain" formControlName="domain">
            <option [selected]="!selectedDomain">Select Domain</option>
            <option *ngFor="let name of domains" [selected]="selectedDomain === name" [ngValue]="name">{{name}}</option>
          </select>
          <p *ngIf="submitted && userForm.get('domain').hasError('required')" class="error-msg">
              Domain is required.
          </p>
        </div>
      </div>

      <!--profile img-->
      <div class="form-group row">
  	    <label for="profile-img" class="col-sm-4 col-form-label">Profile Image</label>
        <div class="col-sm-8">
    	    <input type="file" id="profile-img" [name]="uploadFieldName" (change)="profilePicChange($event.target.name, $event.target.files)" accept="image/*">
    	    <p class="help-block">Upload file size limit 3 MB.</p>
          <p *ngIf="fileSizeError" class="error-msg">
            File size limit exceeds.
          </p>
        </div>
  	  </div>

      <!--email unique error-->
      <p *ngIf="uniqueEmailError" class="error-msg">
        Email already exists.
      </p>

      <!--phone unique error-->
      <p *ngIf="uniquePhoneError" class="error-msg">
        Phone number already exists.
      </p>

      <!--server connection error-->
      <p *ngIf="serverError" class="error-msg">
        Could not connect to server. Please try again later.
      </p>

      <!--submit btn-->
      <div class="form-group text-center">
        <button type="submit" class="btn btn-primary" *ngIf="!userId">Register</button>
        <button type="submit" class="btn btn-primary" *ngIf="userId">Update</button>
        <a [routerLink]="['/login']" class="btn btn-link">Cancel</a>
        <img *ngIf="loading" width="34" src="assets/img/loading.gif" />
      </div>

    </form>
  </div>
</div>

<app-modal [message]="message" [modalType]="modalType" [hidden]="!successMsg"></app-modal>